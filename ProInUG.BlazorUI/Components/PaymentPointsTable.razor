@using ProInUG.BlazorUI.Models
@using Microsoft.AspNetCore.Connections
<MudTable Items="PaymentPoints" Loading="_loading" LoadingProgressColor="Color.Info" Filter="new Func<PaymentPoint, bool>(FilterFunc)" SortLabel="Sort By">
    <ToolBarContent>
        <!-- добавить точку оплаты -->
        <MudIconButton Icon="@Icons.Material.Filled.AddBox" Color="Color.Primary" @onclick="CreatePaymentPointAsync" Class="ml-n2"/>
        <MudText Typo="Typo.h6">Список точек оплаты</MudText>
        <MudSpacer/>
        <!-- Поиск -->
        <MudTextField @bind-Value="_searchString" Immediate="true" Placeholder="Поиск" Adornment="Adornment.Start"
                      AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"/>

    </ToolBarContent>
    <HeaderContent>
        <MudTh>Id</MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<PaymentPoint, object>(x=>x.IsEnable)">Enabled</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<PaymentPoint, object>(x=>x.DeviceUri)">Device url</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<PaymentPoint, object>(x=>x.OperatorName)">Operator name</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<PaymentPoint, object>(x=>x.NomenclatureName)">Nomenclature</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<PaymentPoint, object>(x=>x.TaxationType)">Taxation type</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<PaymentPoint, object>(x=>x.TaxRate)">Tax rate</MudTableSortLabel></MudTh>
        <MudTh>Action</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Id">@context.Id</MudTd>
        <MudTd DataLabel="Is Enable">
            @if (@context.IsEnable)
            {
                <MudIcon Icon="@Icons.Material.Filled.Favorite" Color="Color.Primary"/>
            }
            else
            {
                <MudIcon Icon="@Icons.Material.Filled.FavoriteBorder" Color="Color.Primary"/>
            }
        </MudTd>
        <MudTd DataLabel="Device url">@context.DeviceUri</MudTd>
        <MudTd DataLabel="Operator name">@context.OperatorName</MudTd>
        <MudTd DataLabel="Nomenclature">@context.NomenclatureName</MudTd>
        <MudTd DataLabel="Taxation type">@context.TaxationType</MudTd>
        <MudTd DataLabel="Tax rate">@context.TaxRate</MudTd>
        <MudTd DataLabel="Action">
            <!-- Edit PP button -->
            <MudButton Variant="Variant.Filled" Color="Color.Success" Size="Size.Small"
                       @onclick="() => EditPaymentPointAsync(context)">Edit</MudButton>
            <!-- Delete PP button -->
            <MudButton Variant="Variant.Filled" Color="Color.Error" Size="Size.Small"
                       @onclick="() => DeletePaymentPointAsync(context)">Delete</MudButton>
        </MudTd>
    </RowTemplate>
</MudTable>